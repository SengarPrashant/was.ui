<div class="date-range-wrapper">
      <mat-form-field appearance="outline" class="date-time-full-custom" [ngStyle]="{'top':activeTabIndex === 0 ? '128px': '54px'}">
        <mat-label>Enter a date range</mat-label>
        <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
          <input matStartDate formControlName="start" placeholder="Start date" readonly>
          <input matEndDate formControlName="end" placeholder="End date" readonly>
        </mat-date-range-input>
        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
         <!-- Clear button -->
  <button
    *ngIf="range.value.start || range.value.end"
    mat-icon-button
    matSuffix
    aria-label="Clear date range"
    (click)="clearDateRange($event)">
    <mat-icon>close</mat-icon>
  </button>
        <mat-date-range-picker #picker></mat-date-range-picker>
    
        @if (range.controls.start.hasError('matStartDateInvalid')) {
        <mat-error>Invalid start date</mat-error>
        }
        @if (range.controls.end.hasError('matEndDateInvalid')) {
        <mat-error>Invalid end date</mat-error>
        }
      </mat-form-field>

    </div>
<mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start" animationDuration="0ms" (selectedTabChange)="onTabChange($event)">
  <mat-tab label="Work Permits">
    <app-top-card
    *ngIf="user?.roleId !== 3"
    [topStatus]="wpStatus"
    (clickedStatus)="onStatusClick($event)">
    </app-top-card>
   <app-mat-table
    [data]="tableData"
    [columns]="columns"
    [displayedColumns]="displayedColumns"
    [requiredRightSpace]="false"
    (action)="onAction($event)"
    [actionMenu]="actionMenu"
    [clickedTopStatus]="clickedTopStatus"
    [sticky]="true"
    [activeTabIndex]="activeTabIndex"
></app-mat-table>
  </mat-tab>
  <mat-tab label="Incident">
   <app-mat-table
    [data]="tableData"
    [columns]="columns"
    [displayedColumns]="displayedColumns"
    [requiredRightSpace]="false"
    (action)="onAction($event)"
    [actionMenu]="actionMenuIncident"
    [sticky]="true"
    [activeTabIndex]="activeTabIndex"
></app-mat-table>
  </mat-tab>
</mat-tab-group>

<div class="custom-popup" *ngIf="openDilog">
  <div class="custom-popup-content">
    <div class="popup-header">
      <h1>{{selectedAction === 'view'? 'View' : 'Edit'}} {{activeTabIndex === 0 ? 'work permit':'Incident'}}</h1>
       <button (click)="openDilog = false" class="close-popup">X</button>
    </div>
    <div class="popup-body">
      <app-requst-workflow 
       [workflow]="dataById.workflow || []">
       </app-requst-workflow>
      <app-create-request 
        [dataById]="dataById" 
        [selectedAction]="selectedAction" 
        (CloseEvent)="onClose($event)"
        [requestType]="activeTabIndex === 0 ? 1 : 2"
        >
      </app-create-request>
    </div>
  </div>
</div>
