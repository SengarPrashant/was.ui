
<mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start" animationDuration="0ms" (selectedTabChange)="onTabChange($event)">
  <mat-tab label="Work Permits ({{tableData.length || 0 }})">
    <app-top-card
    *ngIf="user?.roleId !== 3"
    [topStatus]="wpStatus"
    (clickedStatus)="onStatusClick($event)">
    </app-top-card>
    <div class="date-range-wrapper">
      <mat-form-field appearance="outline" class="date-time-full">
        <mat-label>Enter a date range</mat-label>
        <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
          <input matStartDate formControlName="start" placeholder="Start date" readonly>
          <input matEndDate formControlName="end" placeholder="End date" readonly>
        </mat-date-range-input>
        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-date-range-picker #picker></mat-date-range-picker>
    
        @if (range.controls.start.hasError('matStartDateInvalid')) {
        <mat-error>Invalid start date</mat-error>
        }
        @if (range.controls.end.hasError('matEndDateInvalid')) {
        <mat-error>Invalid end date</mat-error>
        }
      </mat-form-field>
    </div>
   <app-mat-table
    [data]="tableData"
    [columns]="columns"
    [displayedColumns]="displayedColumns"
    [requiredRightSpace]="false"
    (action)="onAction($event)"
    [actionMenu]="actionMenu"
    [clickedTopStatus]="clickedTopStatus"
    [sticky]="true"
></app-mat-table>
  </mat-tab>
  <mat-tab label="Incident ({{tableData.length || 0 }})">
    <app-top-card
    [topStatus]="inStatus"
    *ngIf="user?.roleId !== 3"
    (clickedStatus)="onStatusClick($event)">
    </app-top-card>
   <app-mat-table
    [data]="tableData"
    [columns]="columns"
    [displayedColumns]="displayedColumns"
    [requiredRightSpace]="false"
    (action)="onAction($event)"
    [actionMenu]="actionMenu"
    [sticky]="true"
></app-mat-table>
  </mat-tab>
</mat-tab-group>

<div class="custom-popup" *ngIf="openDilog">
  <div class="custom-popup-content">
    <div class="popup-header">
      <h1>{{selectedAction === 'view'? 'View' : 'Edit'}} work permit</h1>
       <button (click)="openDilog = false" class="close-popup">X</button>
    </div>
    <div class="popup-body">
      <app-requst-workflow 
       [workflow]="dataById.workflow || []">
       </app-requst-workflow>
      <app-create-request 
        [dataById]="dataById" 
        [selectedAction]="selectedAction" 
        (CloseEvent)="onClose($event)"
        [requestType]="activeTabIndex === 0 ? 1 : 2"
        >
      </app-create-request>
    </div>
  </div>
</div>
